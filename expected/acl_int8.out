-- ACL format checks
select ''::ace_int8;
ERROR:  missing ACE type
LINE 1: select ''::ace_int8;
               ^
select 'a'::ace_int8;
ERROR:  missing "/" sign
LINE 1: select 'a'::ace_int8;
               ^
select 'q'::ace_int8;
ERROR:  invalid ACE type: must be one of "adi"
LINE 1: select 'q'::ace_int8;
               ^
select 'a*'::ace_int8;
ERROR:  missing "/" sign
LINE 1: select 'a*'::ace_int8;
               ^
select 'a/'::ace_int8;
ERROR:  missing ACE flags
LINE 1: select 'a/'::ace_int8;
               ^
select 'a/hq'::ace_int8;
ERROR:  invalid ACE flag: must be one of "hpcoi0123456789ABCDEFGHIJKLMNOP"
LINE 1: select 'a/hq'::ace_int8;
               ^
select 'a/h'::ace_int8;
ERROR:  missing "/" sign
LINE 1: select 'a/h'::ace_int8;
               ^
select 'a/h/'::ace_int8;
ERROR:  missing ACE who
LINE 1: select 'a/h/'::ace_int8;
               ^
select 'a/h/='::ace_int8;
ERROR:  invalid input syntax for integer: ""
LINE 1: select 'a/h/='::ace_int8;
               ^
select 'a/h/1='::ace_int8;
ERROR:  missing ACE mask
LINE 1: select 'a/h/1='::ace_int8;
               ^
select 'a/h/1=d,'::ace_int8;
ERROR:  invalid ACE mask: must be one of "scdwr0123456789ABCDEFGHIJKLMNOPQ"
LINE 1: select 'a/h/1=d,'::ace_int8;
               ^
select 'a/h/1=dw'::ace_int8;
 ace_int8 
----------
 a/h/1=dw
(1 row)

select 'a/ihpc/1=wdddw'::ace_int8;
  ace_int8   
-------------
 a/hpci/1=dw
(1 row)

select 'd/ihpc/1=wdddw'::ace_int8;
  ace_int8   
-------------
 d/hpci/1=dw
(1 row)

select 'd/ihpc/-9223372036854775808=wdddw'::ace_int8;
            ace_int8            
--------------------------------
 d/hpci/-9223372036854775808=dw
(1 row)

select 'd/ihpc/9223372036854775807=wdddw'::ace_int8;
           ace_int8            
-------------------------------
 d/hpci/9223372036854775807=dw
(1 row)

select 'a/ihpc/blah"=dw0'::ace_int8;
ERROR:  invalid input syntax for integer: ""
LINE 1: select 'a/ihpc/blah"=dw0'::ace_int8;
               ^
select 'd/ihpc/9223372036854775808=wdddw'::ace_int8;
ERROR:  value "9223372036854775808" is out of range for type bigint
LINE 1: select 'd/ihpc/9223372036854775808=wdddw'::ace_int8;
               ^
select 'd/ihpc/922337203685477580800=wdddw'::ace_int8;
ERROR:  int8 too long
LINE 1: select 'd/ihpc/922337203685477580800=wdddw'::ace_int8;
               ^
-- check access
select acl_check_access('{d//1=w,d//2=s,a//2=sdw,a//3=0}'::ace_int8[], 'sd0', '{3, 2}'::int8[], false);
 acl_check_access 
------------------
 0d
(1 row)

-- inherit only
select acl_check_access('{d//1=w,d/i/2=s,a//2=sdw,a//3=0}'::ace_int8[], 'sd0', '{3, 2}'::int8[], false);
 acl_check_access 
------------------
 0sd
(1 row)

